/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],t);else{var r="object"==typeof exports?t(require("blockly/core")):t(e.Blockly);for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(this,(e=>(()=>{"use strict";var t={573:t=>{t.exports=e}},r={};function o(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{CrossTabCopyPaste:()=>i});var e=o(573);function t(t){return{saveInfo:e.serialization.blocks.save(t,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:e.common.getBlockTypeCounts(t,!0)}}function r(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(){function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o)}var s,i;return s=o,i=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{contextMenu:!0,shortcut:!0},r=t.contextMenu,o=void 0===r||r,s=t.shortcut,i=void 0===s||s;o&&(this.blockCopyToStorageContextMenu(),this.blockPasteFromStorageContextMenu()),i&&(e.ShortcutRegistry.registry.unregister(e.ShortcutItems.names.COPY),e.ShortcutRegistry.registry.unregister(e.ShortcutItems.names.CUT),e.ShortcutRegistry.registry.unregister(e.ShortcutItems.names.PASTE),this.blockCopyToStorageShortcut(),this.blockCutToStorageShortcut(),this.blockPasteFromStorageShortcut())}},{key:"blockCopyToStorageContextMenu",value:function(){var r={displayText:function(){return e.Msg.CROSS_TAB_COPY?e.Msg.CROSS_TAB_COPY:"Copy"},preconditionFn:function(e){return"enabled"},callback:function(e){var r=JSON.stringify(t(e.block));localStorage.setItem("blocklyStash",r)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCopyToStorage",weight:0};e.ContextMenuRegistry.registry.register(r)}},{key:"blockPasteFromStorageContextMenu",value:function(){var t={displayText:function(){return e.Msg.CROSS_TAB_PASTE?e.Msg.CROSS_TAB_PASTE:"Paste"},preconditionFn:function(e){var t=JSON.parse(localStorage.getItem("blocklyStash"));return t&&e.workspace.isCapacityAvailable(t.typeCounts)?"enabled":"disabled"},callback:function(e){var t=localStorage.getItem("blocklyStash"),r=JSON.parse(t);e.workspace.paste(r.saveInfo)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"blockPasteFromStorage",weight:0};e.ContextMenuRegistry.registry.register(t)}},{key:"blockCopyToStorageShortcut",value:function(){var r={name:"copy",preconditionFn:function(t){return!t.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()},callback:function(r,o){o.preventDefault(),r.hideChaff();var s=JSON.stringify(t(e.selected));return localStorage.setItem("blocklyStash",s),!0}};e.ShortcutRegistry.registry.register(r);var o=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(o,r.name);var s=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.ALT]);e.ShortcutRegistry.registry.addKeyMapping(s,r.name);var i=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.META]);e.ShortcutRegistry.registry.addKeyMapping(i,r.name)}},{key:"blockCutToStorageShortcut",value:function(){var r={name:"cut",preconditionFn:function(t){return!t.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()&&!e.selected.workspace.isFlyout},callback:function(r,o){o.preventDefault();var s=JSON.stringify(t(e.selected));return localStorage.setItem("blocklyStash",s),e.Events.setGroup(!0),e.selected.dispose(!0),e.Events.setGroup(!1),!0}};e.ShortcutRegistry.registry.register(r);var o=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(o,r.name);var s=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.ALT]);e.ShortcutRegistry.registry.addKeyMapping(s,r.name);var i=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.META]);e.ShortcutRegistry.registry.addKeyMapping(i,r.name)}},{key:"blockPasteFromStorageShortcut",value:function(){var t={name:"paste",preconditionFn:function(t){if(t.options.readOnly||e.Gesture.inProgress())return!1;var r=JSON.parse(localStorage.getItem("blocklyStash"));return!(!r||!t.isCapacityAvailable(r.typeCounts))},callback:function(e,t){t.preventDefault();var r=localStorage.getItem("blocklyStash"),o=JSON.parse(r);return e.paste(o.saveInfo),!0}};e.ShortcutRegistry.registry.register(t);var r=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(r,t.name);var o=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.ALT]);e.ShortcutRegistry.registry.addKeyMapping(o,t.name);var s=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.META]);e.ShortcutRegistry.registry.addKeyMapping(s,t.name)}}],i&&r(s.prototype,i),Object.defineProperty(s,"prototype",{writable:!1}),o}()})(),s})()));
//# sourceMappingURL=index.js.map